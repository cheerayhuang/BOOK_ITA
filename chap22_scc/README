The most parts of this program are mess coied from chap22_dfs.

The test case is on page 338 in ITA. 
